include coreAuthentication.mal

category System {

   asset VulnMachine extends AuthMachine {

	| connect
		-> _authMachineConnect,
			product.connect,
			connectionVulnerabilities.exploit

   | access
      -> _vulnMachineAccess

   | _vulnMachineAccess
      -> _authMachineAccess,
			product.access,
			accessVulnerabilities.exploit
	}

	asset Product {
	
	| connect
		->	connectionVulnerabilities.exploit
	
	| access
		->	accessVulnerabilities.exploit
	}
}

category Security {

   asset Vulnerability {

   | exploit [ExponentialDistribution(10.0)]
      -> privileges.compromise
   }

}


associations {
	VulnMachine	[machines]							*		<-- Installation					--> 0-1	[product]							Product
	VulnMachine	[connectionVulnerableMachine]	*		<-- ConnectionVulnerability	--> 0-1	[connectionVulnerabilities]	Vulnerability
	VulnMachine	[accessVulnerableMachine]		*		<-- AccessVulnerability			--> 0-1	[accessVulnerabilities]			Vulnerability
	Product		[connectionVulnerableProduct]	*		<-- ConnectionVulnerability	--> 0-1	[connectionVulnerabilities]	Vulnerability
	Product		[accessVulnerableProduct]		*		<-- AccessVulnerability			--> 0-1	[accessVulnerabilities]			Vulnerability
   Account     [privileges]            		1-*   <-- Privileges             	--> *    [vulnerabilities]          	Vulnerability
}
